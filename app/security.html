<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Security & Cryptography | The Murderer's Lock</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Playfair+Display:wght@700;900&family=JetBrains+Mono:wght@600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/security.css">
</head>
<body>
  <div class="neon-bg"></div>
  <div class="container">
    <a href="dashboard.html" class="back-link">‚Üê Back to Dashboard</a>
    <h1 class="page-title">Security & Cryptography</h1>
    <p class="page-subtitle">Full transparency. Our cryptographic specification is published for audit and verification.</p>

    <a href="/docs/CRYPTOGRAPHIC-SPECIFICATION.md" download="CRYPTOGRAPHIC-SPECIFICATION.md" class="download-btn">üìÑ Download Full Spec (Markdown)</a>

    <div class="spec-card">
      <h2>1. Overview</h2>
      <p>Server-side encryption with industry-standard algorithms:</p>
      <ul>
        <li><strong>Password hashing:</strong> <span class="badge badge-argon">Argon2id</span> ‚Äî 64 MiB memory, 3 iterations</li>
        <li><strong>Vault encryption:</strong> <span class="badge badge-aes">AES-256-GCM</span> ‚Äî authenticated encryption</li>
        <li><strong>Recovery:</strong> <span class="badge badge-shamir">Shamir 2-of-3</span> ‚Äî any 2 shards reconstruct</li>
        <li><strong>Shard protection:</strong> PBKDF2 (100k) + AES-256-GCM, client-side</li>
      </ul>
      <p>This is not zero-knowledge. The server performs key derivation and decryption. Passwords and plaintext are never stored.</p>
    </div>

    <div class="spec-card">
      <h2>2. Vault Encryption</h2>
      <h3>Key Derivation (Argon2id)</h3>
      <table>
        <tr><th>Parameter</th><th>Value</th></tr>
        <tr><td>Memory cost</td><td>65,536 KiB</td></tr>
        <tr><td>Time cost</td><td>3 iterations</td></tr>
        <tr><td>Hash length</td><td>32 bytes</td></tr>
        <tr><td>Salt</td><td>32 bytes, random</td></tr>
      </table>
      <h3>Vault Encryption (AES-256-GCM)</h3>
      <table>
        <tr><th>Parameter</th><th>Value</th></tr>
        <tr><td>Key size</td><td>256 bits</td></tr>
        <tr><td>IV</td><td>16 bytes, random per encryption</td></tr>
        <tr><td>Auth tag</td><td>16 bytes</td></tr>
      </table>
    </div>

    <div class="spec-card">
      <h2>3. Shamir Recovery</h2>
      <table>
        <tr><th>Parameter</th><th>Value</th></tr>
        <tr><td>Shares</td><td>3</td></tr>
        <tr><td>Threshold</td><td>2</td></tr>
        <tr><td>Secret</td><td>Vault password</td></tr>
      </table>
      <p>Any 2 of 3 shards can reconstruct the password. Shards may be PIN-encrypted in localStorage.</p>
    </div>

    <div class="spec-card">
      <h2>4. Rate Limiting</h2>
      <h3>Unlock</h3>
      <table>
        <tr><th>Limit</th><th>Value</th></tr>
        <tr><td>Attempts per vault</td><td>10 per hour</td></tr>
        <tr><td>Murder threshold</td><td>33 ‚Üí lockjaw</td></tr>
        <tr><td>Constant-time on failure</td><td>5 seconds</td></tr>
      </table>
      <h3>Recovery</h3>
      <table>
        <tr><th>Limit</th><th>Value</th></tr>
        <tr><td>Per IP</td><td>10 per hour</td></tr>
        <tr><td>Per vault</td><td>5 per hour</td></tr>
        <tr><td>Block duration</td><td>24 hours</td></tr>
      </table>
    </div>

    <div class="spec-card">
      <h2>5. Session Tokens</h2>
      <p>Recovery returns <code>{ sessionToken, vaultId }</code> only. Password and contents are never in HTTP responses. Client exchanges token for contents via unlock API.</p>
    </div>

    <div class="spec-card">
      <h2>6. Verification</h2>
      <p>To verify the implementation:</p>
      <ul>
        <li><code>lib/recovery.js</code> ‚Äî Argon2id, AES-GCM, Shamir</li>
        <li><code>app/js/shard-protection.js</code> ‚Äî PBKDF2, AES-GCM</li>
        <li><code>api/unlock-vault.js</code> ‚Äî Rate limits, session tokens</li>
        <li>Browser DevTools Network tab ‚Äî passwords never in responses</li>
      </ul>
    </div>
  </div>
</body>
</html>
